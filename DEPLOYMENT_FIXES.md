# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

## –ü—Ä–æ–±–ª–µ–º—ã

1. **‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞**: `Unknown column 'daily_calories' in 'SET'`
2. **‚ùå AI confidence —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è**: –ø–æ—Å–ª–µ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–∞ —Ç–µ—Ä—è–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å AI –∞–Ω–∞–ª–∏–∑–∞

## –†–µ—à–µ–Ω–∏—è

### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**üî¥ –ö–†–ò–¢–ò–ß–ù–û - –ë–ï–ó –≠–¢–û–ì–û –ù–ï –ë–£–î–£–¢ –†–ê–ë–û–¢–ê–¢–¨ –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò!**

#### –§–∞–π–ª—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```
database/migrations/002_add_missing_fields.sql
deploy-migration.js
```

#### –ö–æ–º–∞–Ω–¥—ã –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –±—ç–∫–µ–Ω–¥–∞
cd /home/snapcalfun/www/backend

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
npm install mysql2 dotenv

# 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
node deploy-migration.js
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ backend —Ñ–∞–π–ª–æ–≤

#### –§–∞–π–ª—ã –¥–ª—è –∑–∞–º–µ–Ω—ã:

```
backend/src/config/database.js         ‚Üí /home/snapcalfun/www/backend/src/config/database.js
backend/src/routes/meals-mysql.js      ‚Üí /home/snapcalfun/www/backend/src/routes/meals-mysql.js
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ frontend —Ñ–∞–π–ª–æ–≤

#### –§–∞–π–ª—ã –¥–ª—è –∑–∞–º–µ–Ω—ã:

```
frontend/utils/api.ts                  ‚Üí –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
frontend/contexts/MealsContext.tsx     ‚Üí –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞

- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –î–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –±–µ–∑ –æ—à–∏–±–∫–∏ `daily_calories`

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ AI confidence

- –°–¥–µ–ª–∞—Ç—å AI –∞–Ω–∞–ª–∏–∑ –µ–¥—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞**: –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫  
‚úÖ **AI confidence**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–ª–æ–≥–∏–Ω–∞  
‚úÖ **AI –¥–∞–Ω–Ω—ã–µ**: –í—Å–µ –ø–æ–ª—è (confidence, language, provider, portions, regional) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

**–¢–∞–±–ª–∏—Ü–∞ `users`:**

- `daily_calories` INT - —Å—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞ –∫–∞–ª–æ—Ä–∏–π

**–¢–∞–±–ª–∏—Ü–∞ `meals`:**

- `confidence` DECIMAL(3,2) - —Ç–æ—á–Ω–æ—Å—Ç—å AI (0.00-1.00)
- `language` VARCHAR(5) - —è–∑—ã–∫ –∞–Ω–∞–ª–∏–∑–∞ (en, ru, uk, pl, es)
- `ai_provider` VARCHAR(50) - –ø—Ä–æ–≤–∞–π–¥–µ—Ä AI (openai, manual, fallback)
- `portions` TEXT - –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Ä—Ü–∏–∏
- `regional` BOOLEAN - —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–µ –±–ª—é–¥–æ

### –ù–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã:

- `idx_meals_confidence` - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏
- `idx_meals_language` - –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —è–∑—ã–∫—É
- `idx_meals_ai_provider` - –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º
- `idx_meals_regional` - –¥–ª—è —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –±–ª—é–¥

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```bash
# –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ:
cd /home/snapcalfun/www/backend

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
node deploy-migration.js

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# pm2 restart snapcal
```
